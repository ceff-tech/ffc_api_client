<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Filter Timeseries data — filter_timeseries • ffcAPIClient</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Filter Timeseries data — filter_timeseries" />
<meta property="og:description" content="When we send data to the FFC, it needs to meet a specific set of requirements.
The code in this file aims to make sure input data, whether gaged or
a manual timeseries, follows those requirements. Namely:" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ffcAPIClient</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.8.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/ceff-steps.html">Use ffcAPIClient to Follow CEFF Steps</a>
    </li>
    <li>
      <a href="../articles/run_multiple_gages.html">Use ffcAPIClient to Run Multiple Gages</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Filter Timeseries data</h1>
    
    <div class="hidden name"><code>filter_timeseries.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>When we send data to the FFC, it needs to meet a specific set of requirements.
The code in this file aims to make sure input data, whether gaged or
a manual timeseries, follows those requirements. Namely:</p>
    </div>

    <pre class="usage"><span class='fu'>filter_timeseries</span>(
  <span class='no'>timeseries</span>,
  <span class='no'>date_field</span>,
  <span class='no'>flow_field</span>,
  <span class='no'>date_format_string</span>,
  <span class='kw'>max_missing_days</span> <span class='kw'>=</span> <span class='fl'>7</span>,
  <span class='kw'>max_consecutive_missing_days</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>fill_gaps</span> <span class='kw'>=</span> <span class='st'>"no"</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>timeseries.</th>
      <td><p>A timeseries data frame with date and flow fields</p></td>
    </tr>
    <tr>
      <th>date_field.</th>
      <td><p>character vector/string with the name of the field that holds the dates</p></td>
    </tr>
    <tr>
      <th>flow_field.</th>
      <td><p>character vector/string with the name of the field that holds flow values</p></td>
    </tr>
    <tr>
      <th>date_format_string.</th>
      <td><p>A format string to use when parsing dates into POSIX time</p></td>
    </tr>
    <tr>
      <th>max_missing_days.</th>
      <td><p>How many days can be missing from each water year before it is
considered too incomplete and will be dropped? The water year will need to have *more*
missing days than this value (so, the default of 7 means that a water year with 7 missing
values will be kept, but a water year with 8 missing values will be dropped).</p></td>
    </tr>
    <tr>
      <th>max_consecutive_missing_days.</th>
      <td><p>How many days in a row can be missing before a water year
is dropped? This is evaluated independently from max_missing_days, so a single failure of the rule
attached to this parameter causes the water year to be dropped. The previous parameter handles the
total number of missing values across a water year, while this parameter only looks at each gap's length.
A max_consecutive_missing_days value of 1 means each gap can only be a single day in length
(so, if we had values for day 1 and 2, were missing day 3, and then had values for day 4 and 5,
that'd be acceptable. If we were also missing day 2 or 4, that would cause the water year to be dropped).</p></td>
    </tr>
    <tr>
      <th>fill_gaps.</th>
      <td><p>Currently unimplemented, but would allow for filling remaining gaps after water the
rules are evaluated according to the other parameters. Defaults to "no", which turns it off. In the
future, we expect to add two other options here: "linear" to linearly inhterpolate across gaps and
"previous" to fill gaps with the closest valid value before the gap.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>1. We should only send complete water years - partial water years at the beginning or end
have an outsize influence on the calculations. This rule will actually be handled just by
adhering to the next two rules.</p>
<p>2. Along the same lines, we shouldn't allow any large gaps. When we find a gap
of *2 or more days*, then we should drop the entire water year.</p>
<p>3. We should only allow 7 total missing days, which we will fill either with
values from the previous day, or a linear interpolation (maybe with a flag?)
before sending to the FFC.</p>
<p>This function accepts a timeseries data frame, assesses/filters it according to these rules,
then returns a new timeseries to the caller. A record is considered a gap if it is missing for a date, or
if it is present, but has a flow value of NA. The timeseries should already be *daily* data.</p>
<p>This function is also staged to fill any remaining gaps in preparation for the online
FFC disabling that functionality, but the code has not yet been enabled here.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://nicksantos.com'>Nick Santos</a>, <a href='https://ryanpeek.github.io/'>Ryan Peek</a>, <a href='https://watershed.ucdavis.edu/people/alyssa-obester'>Alyssa Obester</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


